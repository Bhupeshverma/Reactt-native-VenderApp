["7357121063ab6e21e2dac501b072e47a5b5b5a98","ccabd992333d7485404971188439eb36cfe0ba23",["./constants","./defaults/asyncLocalStorage"],[392,442],{"version":3,"sources":["/home/ziddi/Desktop/venders/node_modules/redux-persist/lib/getStoredState.js"],"names":["exports","__esModule","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","default","getStoredState","_constants","require","_asyncLocalStorage","_asyncLocalStorage2","_interopRequireDefault","obj","config","onComplete","storage","deserializer","serialize","data","defaultDeserializer","blacklist","whitelist","transforms","keyPrefix","undefined","KEY_PREFIX","keys","getAllKeys","restoredState","completionCount","err","allKeys","process","env","NODE_ENV","console","warn","complete","persistKeys","filter","indexOf","map","slice","keysToRestore","passWhitelistBlacklist","restoreCount","forEach","getItem","createStorageKey","serialized","rehydrate","state","reduceRight","subState","transformer","out","Promise","resolve","reject","serial","JSON","parse"],"mappings":"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","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.default = getStoredState;\n\nvar _constants = require('./constants');\n\nvar _asyncLocalStorage = require('./defaults/asyncLocalStorage');\n\nvar _asyncLocalStorage2 = _interopRequireDefault(_asyncLocalStorage);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getStoredState(config, onComplete) {\n  var storage = config.storage || (0, _asyncLocalStorage2.default)('local');\n  var deserializer = config.serialize === false ? function (data) {\n    return data;\n  } : defaultDeserializer;\n  var blacklist = config.blacklist || [];\n  var whitelist = config.whitelist || false;\n  var transforms = config.transforms || [];\n  var keyPrefix = config.keyPrefix !== undefined ? config.keyPrefix : _constants.KEY_PREFIX;\n\n  // fallback getAllKeys to `keys` if present (LocalForage compatability)\n  if (storage.keys && !storage.getAllKeys) storage = _extends({}, storage, { getAllKeys: storage.keys });\n\n  var restoredState = {};\n  var completionCount = 0;\n\n  storage.getAllKeys(function (err, allKeys) {\n    if (err) {\n      if (process.env.NODE_ENV !== 'production') console.warn('redux-persist/getStoredState: Error in storage.getAllKeys');\n      complete(err);\n    }\n\n    var persistKeys = allKeys.filter(function (key) {\n      return key.indexOf(keyPrefix) === 0;\n    }).map(function (key) {\n      return key.slice(keyPrefix.length);\n    });\n    var keysToRestore = persistKeys.filter(passWhitelistBlacklist);\n\n    var restoreCount = keysToRestore.length;\n    if (restoreCount === 0) complete(null, restoredState);\n    keysToRestore.forEach(function (key) {\n      storage.getItem(createStorageKey(key), function (err, serialized) {\n        if (err && process.env.NODE_ENV !== 'production') console.warn('redux-persist/getStoredState: Error restoring data for key:', key, err);else restoredState[key] = rehydrate(key, serialized);\n        completionCount += 1;\n        if (completionCount === restoreCount) complete(null, restoredState);\n      });\n    });\n  });\n\n  function rehydrate(key, serialized) {\n    var state = null;\n\n    try {\n      var data = deserializer(serialized);\n      state = transforms.reduceRight(function (subState, transformer) {\n        return transformer.out(subState, key);\n      }, data);\n    } catch (err) {\n      if (process.env.NODE_ENV !== 'production') console.warn('redux-persist/getStoredState: Error restoring data for key:', key, err);\n    }\n\n    return state;\n  }\n\n  function complete(err, restoredState) {\n    onComplete(err, restoredState);\n  }\n\n  function passWhitelistBlacklist(key) {\n    if (whitelist && whitelist.indexOf(key) === -1) return false;\n    if (blacklist.indexOf(key) !== -1) return false;\n    return true;\n  }\n\n  function createStorageKey(key) {\n    return '' + keyPrefix + key;\n  }\n\n  if (typeof onComplete !== 'function' && !!Promise) {\n    return new Promise(function (resolve, reject) {\n      onComplete = function onComplete(err, restoredState) {\n        if (err) reject(err);else resolve(restoredState);\n      };\n    });\n  }\n}\n\nfunction defaultDeserializer(serial) {\n  return JSON.parse(serial);\n}"]}]